# Firestore Database Setup Guide for Mechanic Dashboard

Your Firebase is already configured! Now you need to set up your Firestore database with the correct structure.

## üìã Required Collections

### 1. **users** Collection
This collection stores user information including their role.

#### For Each User Document:
**Document ID:** `{user.uid}` (automatically generated by Firebase Auth)

**Fields:**
```javascript
{
  email: "user@example.com",              // string
  displayName: "John Doe",                 // string
  userType: "customer",                    // string: "customer" | "mechanic" | "admin"
  photoURL: "https://...",                 // string (optional)
  createdAt: Timestamp                     // Firestore Timestamp
}
```

#### Example Documents:

**Customer User:**
```javascript
// Document ID: "abc123xyz" (from Firebase Auth)
{
  email: "customer@example.com",
  displayName: "Jane Customer",
  userType: "customer",
  createdAt: firebase.firestore.Timestamp.now()
}
```

**Mechanic User:**
```javascript
// Document ID: "def456uvw" (from Firebase Auth)
{
  email: "mechanic@example.com",
  displayName: "John Mechanic",
  userType: "mechanic",
  createdAt: firebase.firestore.Timestamp.now()
}
```

---

### 2. **mechanics** Collection
This collection stores mechanic/workshop profiles.

#### For Each Mechanic Document:
**Document ID:** Auto-generated by Firestore

**Fields:**
```javascript
{
  userId: "def456uvw",                     // string - MUST match the user document ID
  name: "John Mechanic",                   // string
  phone: "+1234567890",                    // string
  workshop_name: "Smith Auto Repair",      // string
  latitude: 40.7128,                       // number
  longitude: -74.0060,                     // number
  services: ["car", "emergency"],          // array of strings
  rating: 4.5,                             // number (0-5)
  is_open: true,                           // boolean
  photo: "https://via.placeholder.com/100", // string (URL)
  reviews_count: 23                        // number
}
```

#### Example Document:
```javascript
// Document ID: auto-generated (e.g., "mech_001")
{
  userId: "def456uvw",                     // Links to user document
  name: "John Smith",
  phone: "+1234567890",
  workshop_name: "Smith Auto Repair",
  latitude: 40.7128,
  longitude: -74.0060,
  services: ["car", "bike", "emergency"],
  rating: 4.8,
  is_open: true,
  photo: "https://via.placeholder.com/100",
  reviews_count: 45
}
```

---

### 3. **requests** Collection
This collection stores service requests from customers to mechanics.

#### For Each Request Document:
**Document ID:** Auto-generated by Firestore

**Fields:**
```javascript
{
  userId: "abc123xyz",                     // string - customer's user ID
  mechanicId: "mech_001",                  // string - mechanic document ID
  userName: "Jane Customer",               // string
  mechanicName: "John Smith",              // string
  serviceType: "car",                      // string
  status: "pending",                       // string: "pending" | "accepted" | "in_progress" | "completed" | "cancelled"
  urgency: "high",                         // string: "low" | "medium" | "high" | "emergency" (optional)
  description: "My car won't start",       // string (optional)
  createdAt: Timestamp,                    // Firestore Timestamp
  updatedAt: Timestamp                     // Firestore Timestamp
}
```

---

## üöÄ Quick Setup Steps

### Option 1: Manual Setup via Firebase Console

1. **Go to Firebase Console:**
   - Visit: https://console.firebase.google.com/
   - Select project: `garagemap-11a27`
   - Navigate to **Firestore Database**

2. **Create Collections:**
   - Click "Start collection"
   - Create `users` collection
   - Create `mechanics` collection  
   - Create `requests` collection

3. **Add Sample Data:**
   - Add a test mechanic user (see examples above)
   - Link mechanic profile to user
   - Add sample requests for testing

### Option 2: Programmatic Setup (Recommended)

I can create a setup script for you that will:
- Create test users
- Create mechanic profiles
- Add sample service requests
- Set up proper data structure

---

## üîë Important Rules

### **Critical: userType Field**
Every user MUST have a `userType` field:
- New signups via your app need to set this during registration
- Existing users need to have this field added manually or via migration

### **Linking Users to Mechanics**
The `mechanics` collection document MUST have:
- `userId` field that matches a user document ID
- This links the mechanic profile to the login account

### **Service Requests**
- `mechanicId` must match a document ID in the `mechanics` collection
- `userId` must match a document ID in the `users` collection

---

## üìù Testing Checklist

After setup, verify:
- [ ] Users collection exists with at least one mechanic user
- [ ] Mechanic user has `userType: "mechanic"`
- [ ] Mechanics collection has profile linked to user via `userId`
- [ ] Can login with mechanic account
- [ ] Redirects to `/mechanic-dashboard`
- [ ] Dashboard displays correctly (even if no requests)
- [ ] Test creating a service request
- [ ] Request appears in mechanic dashboard

---

## üÜò Need Help?

If you want me to:
1. Create a script to populate test data
2. Create a Firebase security rules file
3. Help troubleshoot connection issues

Just let me know!
